<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Manage your properties - EstateHub">
  <title>Property Management | EstateHub</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>
<body class="dashboard">
  <div class="sidebar">
    <h2>ğŸ  Admin Panel</h2>
    <ul>
      <li><a href="admin-dashboard.html">ğŸ“Š Dashboard</a></li>
      <li><a href="properties.html" class="active">ğŸ˜ Properties</a></li>
      <li><a href="tenants.html">ğŸ‘¥ Tenants</a></li>
      <li><a href="#">ğŸ’° Payments</a></li>
      <li><a href="#">ğŸ“‹ Reports</a></li>
      <li><a href="index.html">ğŸšª Logout</a></li>
    </ul>
  </div>

  <div class="container">
    <h2>ğŸ  Property Management</h2>

    <!-- Search + Filter + Add Button -->
    <div class="top-bar">
      <input type="text" id="searchProperty" placeholder="ğŸ” Search by name or location...">
      <select id="statusFilter">
        <option value="">All Status</option>
        <option value="available">Available</option>
        <option value="occupied">Occupied</option>
      </select>
      <button id="addPropertyBtn" class="btn">+ Add Property</button>
    </div>

    <!-- Property Table -->
    <div class="table-section">
      <table>
        <thead>
          <tr>
            <th>Image</th>
            <th>Name</th>
            <th>Location</th>
            <th>Price (KSh)</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="propertyTableBody">
          <!-- Properties will be dynamically loaded here -->
        </tbody>
      </table>
    </div>
  </div>

  <!-- Property Popup Modal -->
  <div id="propertyPopup" class="modal">
    <div class="modal-content">
      <h3 id="popupTitle">Add Property</h3>
      <form id="propertyForm">
        <input type="hidden" id="propertyId">
        
        <label for="propertyName">Property Name</label>
        <input type="text" id="propertyName" placeholder="e.g., Sunset Apartments" required>
        
        <label for="propertyLocation">Location</label>
        <input type="text" id="propertyLocation" placeholder="e.g., Westlands, Nairobi" required>
        
        <label for="propertyPrice">Monthly Rent (KSh)</label>
        <input type="number" id="propertyPrice" placeholder="e.g., 50000" required min="0">
        
        <label for="propertyStatus">Status</label>
        <select id="propertyStatus" required>
          <option value="available">Available</option>
          <option value="occupied">Occupied</option>
        </select>
        
        <label for="propertyImage">Property Image URL</label>
        <input type="text" id="propertyImage" placeholder="https://example.com/image.jpg">
        
        <div class="popup-buttons">
          <button type="submit" class="btn">Save Property</button>
          <button type="button" id="cancelPropertyBtn" class="btn cancel-btn">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <script src="js/script.js"></script>
  <script>
    // Sample property data
    let properties = [
      {
        id: 1,
        name: 'Sunset Apartments',
        location: 'Westlands, Nairobi',
        price: 50000,
        status: 'available',
        image: 'https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=400'
      },
      {
        id: 2,
        name: 'Green Valley Estate',
        location: 'Karen, Nairobi',
        price: 75000,
        status: 'occupied',
        image: 'https://images.unsplash.com/photo-1512917774080-9991f1c4c750?w=400'
      },
      {
        id: 3,
        name: 'City Center Loft',
        location: 'CBD, Nairobi',
        price: 60000,
        status: 'available',
        image: 'https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?w=400'
      }
    ];

    // Render properties table
    function renderProperties(filteredProperties = properties) {
      const tbody = document.getElementById('propertyTableBody');
      tbody.innerHTML = '';

      filteredProperties.forEach(property => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td><img src="${property.image}" alt="${property.name}" style="width: 60px; height: 60px; object-fit: cover; border-radius: 8px;"></td>
          <td><strong>${property.name}</strong></td>
          <td>${property.location}</td>
          <td>KSh ${property.price.toLocaleString()}</td>
          <td><span class="status ${property.status}">${property.status.charAt(0).toUpperCase() + property.status.slice(1)}</span></td>
          <td class="action-buttons">
            <button class="edit" onclick="editProperty(${property.id})">âœï¸ Edit</button>
            <button class="delete" onclick="deleteProperty(${property.id})">ğŸ—‘ï¸ Delete</button>
          </td>
        `;
        tbody.appendChild(row);
      });
    }

    // Search functionality
    document.getElementById('searchProperty')?.addEventListener('input', function(e) {
      const searchTerm = e.target.value.toLowerCase();
      const filtered = properties.filter(p => 
        p.name.toLowerCase().includes(searchTerm) || 
        p.location.toLowerCase().includes(searchTerm)
      );
      renderProperties(filtered);
    });

    // Filter by status
    document.getElementById('statusFilter')?.addEventListener('change', function(e) {
      const status = e.target.value;
      const filtered = status ? properties.filter(p => p.status === status) : properties;
      renderProperties(filtered);
    });

    // Add property button
    document.getElementById('addPropertyBtn')?.addEventListener('click', function() {
      document.getElementById('popupTitle').textContent = 'Add Property';
      document.getElementById('propertyForm').reset();
      document.getElementById('propertyId').value = '';
      document.getElementById('propertyPopup').classList.add('active');
    });

    // Save property
    document.getElementById('propertyForm')?.addEventListener('submit', function(e) {
      e.preventDefault();
      
      const id = document.getElementById('propertyId').value;
      const property = {
        id: id ? parseInt(id) : Date.now(),
        name: document.getElementById('propertyName').value,
        location: document.getElementById('propertyLocation').value,
        price: parseInt(document.getElementById('propertyPrice').value),
        status: document.getElementById('propertyStatus').value,
        image: document.getElementById('propertyImage').value || 'https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=400'
      };

      if (id) {
        // Update existing property
        const index = properties.findIndex(p => p.id === parseInt(id));
        properties[index] = property;
      } else {
        // Add new property
        properties.push(property);
      }

      renderProperties();
      document.getElementById('propertyPopup').classList.remove('active');
      alert('Property saved successfully!');
    });

    // Edit property
    window.editProperty = function(id) {
      const property = properties.find(p => p.id === id);
      if (!property) return;

      document.getElementById('popupTitle').textContent = 'Edit Property';
      document.getElementById('propertyId').value = property.id;
      document.getElementById('propertyName').value = property.name;
      document.getElementById('propertyLocation').value = property.location;
      document.getElementById('propertyPrice').value = property.price;
      document.getElementById('propertyStatus').value = property.status;
      document.getElementById('propertyImage').value = property.image;
      
      document.getElementById('propertyPopup').classList.add('active');
    };

    // Delete property
    window.deleteProperty = function(id) {
      if (confirm('Are you sure you want to delete this property?')) {
        properties = properties.filter(p => p.id !== id);
        renderProperties();
        alert('Property deleted successfully!');
      }
    };

    // Initial render
    renderProperties();
  </script>
</body>
</html>